<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta property="og:type" content="article">
<meta property="og:image" content="http://ufo.stealien.com/assets/og_image.png">
<meta property="og:title" content="STEALIEN Technical Blog">
<meta property="og:description" content="Homomorphism in RSA">
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700&display=swap" rel="stylesheet">
<title>Homomorphism in RSA</title>
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Homomorphism in RSA | STEALIEN Technical Blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Homomorphism in RSA" />
<meta name="author" content="λ°•μ§€μ›" />
<meta property="og:locale" content="ko" />
<meta name="description" content="Homomorphism in RSA" />
<meta property="og:description" content="Homomorphism in RSA" />
<link rel="canonical" href="http://ufo.stealien.com/2022-06-08/homomorphism-in-rsa" />
<meta property="og:url" content="http://ufo.stealien.com/2022-06-08/homomorphism-in-rsa" />
<meta property="og:site_name" content="STEALIEN Technical Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-07T08:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Homomorphism in RSA" />
<script type="application/ld+json">
{"headline":"Homomorphism in RSA","dateModified":"2022-06-07T08:00:00-07:00","datePublished":"2022-06-07T08:00:00-07:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://ufo.stealien.com/2022-06-08/homomorphism-in-rsa"},"url":"http://ufo.stealien.com/2022-06-08/homomorphism-in-rsa","author":{"@type":"Person","name":"λ°•μ§€μ›"},"description":"Homomorphism in RSA","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name=β€naver-site-verificationβ€ content=β€74a9ec74d48a1ffca92bf9ac4704ba73be9afd65" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"/>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<link rel="stylesheet" href="/assets/css/style.css">

<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>

<link href="/assets/css/syntax.css" rel="stylesheet" >


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-06FFJEF76M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-06FFJEF76M');
</script>
</head>
<body>
	<header>
		<div class="container"></div><div id="header">
    <div class="container" style="display: flex;justify-content: space-between;">
        <a href="/">
            <img
                class="header_image_logo"
                src="/assets/logo.png"
                style="width: 140px; margin: 20px 28px 0px;"
            />
        </a>
        <a href="https://www.stealien.com/" target="_blank" style="font-family: 'NotoSansKR Medium', sans-serif;font-size: 14px;margin-right: 30px; color: #000; line-height: 70px;">μ¤ν‹Έλ¦¬μ–Έ ν™νμ΄μ§€</a>
    </div>
</div>
</header>
	<section>
		<div>
			<div class="header_image_bg header_image_post" style="background-image: url('/assets/bg.png');">
    <div class="header_image_post_body">
        <div class="container">
            <div class="page-category">R&D</div>
            <div class="page-title">Homomorphism in RSA</div>
            <div class="page-summary">
                <div style="float:left;">
                    <img class="page-profile_image" src="/assets/stealien_inverse.png" />
                    <span>λ°•μ§€μ›</span>
                </div>
                <div style="float:right;" class="page-date">Jun 7, 2022</div>
            </div>
        </div>
    </div>
</div>
<div class="container page-content">
    <h1 id="homomorphism-in-rsa">Homomorphism in RSA</h1>

<h1 id="μ„λ΅ ">μ„λ΅ </h1>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/001_markus-spiske-iar-afB0QQw-unsplash_edit.jpg" alt="001_markus-spiske-iar-afB0QQw-unsplash_edit.jpg" /></p>

<p>ν•΄ν‚Ήμ— κ΄€μ‹¬μ„ κ°€μ§€κ² λ μ‚¬λμ΄λΌλ©΄ λ„κµ¬λ“ μ§€ κ·Έ μ‹¤λ ¥μ„ κΈ°λ¥΄κΈ° μ„ν•΄ μ›κ²μ„(Wargame) μ‚¬μ΄νΈμ—μ„ λ¬Έμ λ“¤μ„ ν’€κ±°λ‚ CTF(Capture The Flag) λ€νμ— μ¶μ „ν•΄ λ³Έ μ μ΄ μμ„ κ²ƒμ΄λ‹¤. μ›Ή(Web), λ¦¬λ²„μ‹±(Reversing), ν¬λ„λΈ”(Pwnable) λ“± μ—¬λ¬ λ¶„μ•Όμ λ¬Έμ λ“¤μ„ λ§λ‚λ³Ό μ μλ”λ°, νΉλ³„ν• κ²½μ°λ¥Ό μ μ™Έν•κ³  ν•­μƒ λ“±μ¥ν•λ” λ¶„μ•Όκ°€ μλ‹¤. λ°”λ΅ <strong>μ•”νΈν•™(Cryptography)</strong> λ¶„μ•Όμ΄λ‹¤.</p>

<p>μμ£Ό λ“±μ¥ν•λ” λ§νΌ ν¨κΈ° μκ² λ¬Έμ λ¥Ό ν’€μ–΄λ³΄λ ¤ ν•μ§€λ§ μ•”νΈν•™ λ¶„μ•Όμ λ¬Έμ λ¥Ό μ²μ μ ‘ν•΄λ³΄λ” μ‚¬λμ΄λΌλ©΄ λ„κµ¬λ“ μ§€ κ΄΄μƒν•κ² λ’¤μ£½λ°•μ£½ μ„μ—¬ μκ±°λ‚ μ«μλ΅λ§ λμ–΄ μλ” μ•”νΈλ¬Έμ„ λ°›μ•„λ³΄λ©° μ΄κ²ƒμ„ ν’€μ–΄μ„ μ •λ‹µμ„ μ μ¶ν•λΌλ” λ§μ— μ–΄λ–»κ² ν•΄μ•Ό ν• μ§€ μ‹μ‘λ¶€ν„° <strong>λ§‰λ§‰ν–λ κ²½ν—</strong>μ΄ μμ„ κ²ƒμ΄λ‹¤.</p>

<p>μ΄λ² κΈ€μ—μ„λ” μ•”νΈν•™μ΄λΌλ” λ¶„μ•Όμ— λ€ν•΄ λ§‰μ—°ν μ–΄λ µκ³  λ³µμ΅ν•λ‹¤κ³  μƒκ°ν•λ” μ‚¬λλ“¤μ„ μ„ν•΄ μ•”νΈν•™ λ¶„μ•Όμ μ›κ²μ„ λ¬Έμ μ—μ„ κ°€μ¥ ν”ν•κ² λ‚μ¤κ³  μ‹¤μ  ν•„λ“μ—μ„λ„ λ§μ΄ μ“°μ΄λ” κ³µκ°ν‚¤ μ•”νΈν™” κΈ°λ²•μ κΈ°λ³Έ μ¤‘μ κΈ°λ³Έ, <strong>RSA</strong> μ™€ κ΄€λ ¨λ λ¬Έμ λ¥Ό ν’€μ–΄λ³΄λ©° μ•”νΈν•™μ΄λΌλ” κ² κ·Έλ ‡κ² μ–΄λ µκ³  λ§‰λ§‰ν•κΈ°λ§ ν• κ²ƒμ€ μ•„λ‹λΌλ” μ μ„ λ°°μ›κ° μ μλ‹¤λ©΄ μΆ‹κ² λ‹¤.</p>

<hr />

<h1 id="λ³Έλ΅ ">λ³Έλ΅ </h1>

<h2 id="κ·Έλμ„-rsa-κ°€-λ­”κ°€μ”">κ·Έλμ„ RSA κ°€ λ­”κ°€μ”?</h2>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/002_RSA_inventors.jpeg" alt="002_RSA_inventors.jpeg" /></p>

<p>RSA λ” 1978λ…„μ— μµμ΄λ΅ μ΄ μ•”νΈμ‹μ¤ν…μ„ μ—°κµ¬ν•μ—¬ μ²΄κ³„ν™”μ‹ν‚¨ Ron <strong>R</strong>ivest, Adi <strong>S</strong>hamir, Leonard <strong>A</strong>dleman μ μ΄λ¦„ μ• κΈ€μλ¥Ό λ”° λ§λ“¤μ–΄μ§„ <strong>μ•”νΈν™”</strong>λΏλ§ μ•„λ‹λΌ <strong>μ „μμ„λ…</strong>κΉμ§€ κ°€λ¥ν• μµμ΄μ μ•κ³ λ¦¬μ¦μ΄λ‹¤.</p>

<p>μ΄ RSA μ κ°•λ ¥ν•¨μ€ λ‹¤μ λ‘ κ°€μ§€μ—μ„ λ‚μ¨λ‹¤.</p>

<ol>
  <li>μ•”/λ³µνΈν™”, μ„λ…/κ²€μ¦μ— ν•„μ”ν• μν•™μ μΈ κ³„μ‚° κ³Όμ •μ΄ κµ‰μ¥ν κ°„λ‹¨ν•κ³  λΉ λ¥΄λ‹¤λ” κ²ƒ.</li>
  <li>ν° μ«μμ μ†μΈμλ¶„ν•΄μ μ–΄λ ¤μ›€μ„ μ΄μ©ν• κ°•λ ¥ν• μ•μ „μ„±μ„ μ κ³µν•κ³  μλ‹¤λ” κ²ƒ.</li>
</ol>

<p>μ„ λ‘ κ°€μ§€μ κ°•μ μΌλ΅ μΈν•΄ ν„μ¬κΉμ§€λ„ RSA λ” λ„λ¦¬ μ“°μ΄κ³  μλ‹¤.</p>

<p>λ‹¤μμΌλ΅λ” μ™ RSA μ κ°•μ μ„ μ„ λ‘ κ°€μ§€λ΅ κΌ½μ•λ”μ§€ ν‚¤ μƒμ„±λ¶€ν„° μ•”/λ³µνΈν™”, μ„λ…/κ²€μ¦ κ³Όμ •μ„ μ‚΄ν΄λ³΄λ©° μ•μ•„λ³΄λ„λ΅ ν•κ² λ‹¤.</p>

<h2 id="rsa-ν‚¤-μƒμ„±">RSA ν‚¤ μƒμ„±</h2>

<ol>
  <li>μ„λ΅ λ‹¤λ¥Έ <strong>μ†μ p, q</strong> λ¥Ό λλ¤ν•κ² μ„ νƒν•λ‹¤.</li>
  <li>
    <p><strong>n = p * q</strong> λ¥Ό κ³„μ‚°ν•λ‹¤.
<img src="/assets/2022-06-08-homomorphism-in-rsa/003_npq.png" alt="003_n=pq.png" /></p>
  </li>
  <li>n μ— λ€ν•μ—¬ <strong>μ¤μΌλ¬ ν”Ό ν•¨μ(Eulerβ€™s phi (totient) function)</strong> λλ” <strong>μΉ΄λ§μ΄ν΄ ν•¨μ(Carmichael function)</strong> μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•μ—¬ κ³„μ‚°ν•λ‹¤.
    <ul>
      <li>μ¤μΌλ¬ ν”Ό ν•¨μ (<a href="https://ko.wikipedia.org/wiki/%EC%98%A4%EC%9D%BC%EB%9F%AC_%ED%94%BC_%ED%95%A8%EC%88%98">https://ko.wikipedia.org/wiki/μ¤μΌλ¬_ν”Ό_ν•¨μ</a>)
 <img src="/assets/2022-06-08-homomorphism-in-rsa/004_phi.png" alt="004_phi.png" /></li>
      <li>μΉ΄λ§μ΄ν΄ ν•¨μ (<a href="https://en.wikipedia.org/wiki/Carmichael_function">https://en.wikipedia.org/wiki/Carmichael_function</a>)
 <img src="/assets/2022-06-08-homomorphism-in-rsa/005_lambda.png" alt="005_lambda.png" /></li>
    </ul>
  </li>
  <li>
    <p>3λ²μ—μ„ μ„ νƒν• μμ™€ <strong>μ„λ΅μ†μΈ μ •μ e</strong> λ¥Ό κ³ λ¥Έλ‹¤.</p>

    <p>(λ‘ μ •μ a, b μ μµλ€κ³µμ•½μ(gcd)κ°€ 1 μ΄λ©΄ λ‘μ€ μ„λ΅μ†μ΄λ‹¤.)</p>

    <p>(λ‘ μκ°€ μ„λ΅μ†κ°€ μ•„λ‹λ©΄ λ¨λ“λ¬ μ—­μ›μ„ κµ¬ν•  μ μ—†λ‹¤ β†’ κ°μΈν‚¤λ¥Ό κµ¬ν•  μ μ—†λ‹¤.)</p>

    <p><img src="/assets/2022-06-08-homomorphism-in-rsa/006_gcd_coprime.png" alt="006_gcd_coprime.png" /></p>

    <p>(μΌλ°μ μΌλ΅ κ³„μ‚°μ ν¨μ¨μ„±μ„ μ„ν•΄ <a href="https://ko.wikipedia.org/wiki/%ED%8E%98%EB%A5%B4%EB%A7%88_%EC%88%98">νλ¥΄λ§ μ(Fermat Number)</a>κ°€ μ„ νƒλλ‹¤.)</p>

    <p><img src="/assets/2022-06-08-homomorphism-in-rsa/007_Fermat_numbers.png" alt="007_Fermat_numbers.png" /></p>
  </li>
  <li>
    <p>μ •μ e μ— λ€ν• <strong>λ¨λ“λ¬ μ—­μ›μΈ d</strong> λ¥Ό κ³„μ‚°ν•λ‹¤.
<img src="/assets/2022-06-08-homomorphism-in-rsa/008_private_key_d.png" alt="008_private_key_d.png" /></p>
  </li>
  <li>μ„μ—μ„ κ³„μ‚°ν• κ°’λ“¤ μ¤‘ <strong>n, e λ¥Ό κ³µκ°ν‚¤</strong>λ΅μ¨ λ°°ν¬ν•κ³ , <strong>d λ¥Ό κ°μΈν‚¤</strong>λ΅μ¨ μ λ€ λ…Έμ¶λμ§€ μ•κ² ν•λ‹¤.
<img src="/assets/2022-06-08-homomorphism-in-rsa/009_keys.png" alt="009_keys.png" /></li>
</ol>

<p>μ΄μ  ν•΄λ‹Ή κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•μ—¬ λ„κµ¬λ“ μ§€ λ©”μ‹μ§€λ¥Ό μ•”νΈν™”ν•΄μ„ λ³΄λ‚΄λ©΄ κ°μΈν‚¤λ¥Ό κ°€μ§€κ³  μλ” μ†μ μλ§ ν•΄λ‹Ή λ©”μ‹μ§€λ¥Ό λ³µνΈν™”ν•  μ μλ‹¤. κ·Έλ ‡λ‹¤λ©΄ μ•”/λ³µνΈν™”λ” μ–΄λ–»κ² μν–‰λ κΉ? ν•λ² μ‚΄ν΄λ³΄μ.</p>

<h2 id="rsa-μ•”νΈν™”">RSA μ•”νΈν™”</h2>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/010_enc.png" alt="010_enc.png" /></p>

<h2 id="rsa-λ³µνΈν™”">RSA λ³µνΈν™”</h2>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/011_dec.png" alt="011_dec.png" /></p>

<p>μ„μ™€ κ°™μ΄ μ •λ§ κ°„λ‹¨ν•κ² μ•”/λ³µνΈν™”κ°€ μν–‰λλ©° μ΄μ— λ€ν• μ¦λ…μ€ <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Proofs_of_correctness">RSA μ„ν‚¤</a>μ— μƒμ„Έν•κ² λ‚μ™€μλ‹¤.</p>

<p>(νλ¥΄λ§ μ†μ •λ¦¬, μ¤μΌλ¬ μ •λ¦¬λ¥Ό μ΄μ©ν•μ—¬ μ¦λ…ν•¨)</p>

<p>μ΄λ²μ—λ” μ„λ…/κ²€μ¦μ΄ μ–΄λ–»κ² μν–‰λλ”μ§€ μ‚΄ν΄λ³΄μ.</p>

<h2 id="rsa-μ„λ…">RSA μ„λ…</h2>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/012_sign.png" alt="012_sign.png" /></p>

<h2 id="rsa-κ²€μ¦">RSA κ²€μ¦</h2>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/013_verify.png" alt="013_verify.png" /></p>

<p>μ•”/λ³µνΈν™” κ³Όμ •κ³Ό μμ„λ§ λ°”λ€μ—μ„ λΏ κ±°μ λ™μΌν•κ² μ„λ…/κ²€μ¦μ΄ μν–‰λλ©° μ„λ… μ‹ κ°μΈν‚¤ d λ¥Ό μ΄μ©ν•΄ μ„λ…μ΄ λκΈ° λ•λ¬Έμ— λ„κµ¬μ—κ²λ‚ κ³µκ°λλ” e λ¥Ό μ΄μ©ν•΄ λ©”μ‹μ§€ m μ„ λ³µμ›ν•  μ μ—†λ„λ΅ ν•΄μ‹ ν•¨μλ¥Ό μ΄μ©ν•μ—¬ λ©”μ‹μ§€ m μ ν•΄μ‹κ°’μΈ h μ— μ„λ…μ„ μ§„ν–‰ν•λ„λ΅ ν•λ‹¤.</p>

<p>λ©”μ‹μ§€μ— λ€ν• μ„λ…μ΄ μ™„λ£λμ—λ‹¤λ©΄ μ•”νΈν™”λ λ©”μ‹μ§€μ™€ μ„λ…μ„ ν•¨κ» μ „μ†΅ν•κ³  μ΄ν›„ κ²€μ¦ λ‹¨κ³„μ—μ„λ” λ³µνΈν™”λ λ©”μ‹μ§€μ ν•΄μ‹κ°’κ³Ό s^e (mod n) μ„ κ³„μ‚°ν•μ—¬ λ‚μ¨ ν•΄μ‹κ°’ h λ¥Ό λΉ„κµν•μ—¬ μΌμΉν•λ”μ§€ ν™•μΈν•λ©΄ λλ‹¤.</p>

<p>μ΄μ  RSA μ‹μ¤ν…μ— λ€ν• κΈ°λ³Έμ μΈ κ°λ…μ„ λ°°μ› μΌλ‹ ν¥λ―Έλ΅μ΄ μ†μ„± ν•λ‚λ¥Ό μ¶”κ°€λ΅ μ•λ ¤μ£Όλ ¤κ³  ν•λ‹¤.</p>

<h2 id="μ¤€λ™ν•-μ‚¬μƒhomomorphism">μ¤€λ™ν• μ‚¬μƒ(Homomorphism)</h2>

<p>μ¤€λ™ν• μ‚¬μƒμ΄λ€ λ€μν•™μ—μ„ κµ¬μ΅°μƒ λ‹®μ€ λ‘ λ€μ κµ¬μ΅°μ λ¨λ“  μ—°μ‚° λ° κ΄€κ³„λ¥Ό λ³΄μ΅΄ν•λ” κ²½μ°λ¥Ό λ§ν•λ‹¤. μ‰½κ² λ§ν•μλ©΄, μ–΄λ– ν• ν•¨μ <code class="language-plaintext highlighter-rouge">f(x)</code> κ°€ μλ‹¤κ³  ν•  λ• <code class="language-plaintext highlighter-rouge">f(a * b)</code> κ°€ <code class="language-plaintext highlighter-rouge">f(a) * f(b)</code> μ™€ κ°™λ‹¤λ” κ²ƒμ΄λ‹¤ (λ‚λ—μ…λ„ λ§μ°¬κ°€μ§€). μ΄λ” μ‹ κΈ°ν•κ²λ„ RSA μ—λ„ κ·Έλ€λ΅ μ μ©μ΄ λλ”λ° ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">m</code> μ΄ <code class="language-plaintext highlighter-rouge">a * b</code> λΌκ³  ν•  λ• c β‰΅ m^e (mod n) κ³Ό c β‰΅ (a * b)^e β‰΅ a^e * b^e (mod n) μ΄ μ„λ΅ μΌμΉν•λ‹¤. μ΄λ” μ„λ…μ—μ„λ„ λ§μ°¬κ°€μ§€μ΄λ©° μμ‹λ¥Ό ν†µν•΄ ν™•μΈν•΄λ³΄μ.</p>

<h2 id="μμ‹">μμ‹</h2>

<ol>
  <li>
    <p>μ„μμ μ†μ p, q μ„ νƒ
<img src="/assets/2022-06-08-homomorphism-in-rsa/014_pq.png" alt="014_pq.png" /></p>
  </li>
  <li>
    <p>n = p * q κ³„μ‚°
<img src="/assets/2022-06-08-homomorphism-in-rsa/015_npq3233.png" alt="015_n=pq=3233.png" /></p>
  </li>
  <li>
    <p>μ¤μΌλ¬ ν”Όν•¨μ κ³„μ‚°
<img src="/assets/2022-06-08-homomorphism-in-rsa/016_phi(n).png" alt="016_phi(n).png" /></p>
  </li>
  <li>
    <p>μ¤μΌλ¬ ν”Όν•¨μμ™€ μ„λ΅μ†μΈ μ •μ e μ„ νƒ
<img src="/assets/2022-06-08-homomorphism-in-rsa/017_e17.png" alt="017_e=17.png" /></p>
  </li>
  <li>
    <p>κ°μΈν‚¤ d κ³„μ‚°
<img src="/assets/2022-06-08-homomorphism-in-rsa/018_private_key_d.png" alt="018_private_key_d.png" /></p>
  </li>
  <li>
    <p>ν‰λ¬Έ m = a * b λΌκ³  ν•  λ• μ•”νΈν™” κ³Όμ • λΉ„κµ
<img src="/assets/2022-06-08-homomorphism-in-rsa/019_enc.png" alt="019_enc.png" /></p>
  </li>
  <li>
    <p>μ„λ… κ³Όμ • λΉ„κµ (κ³„μ‚° νΈμλ¥Ό μ„ν•΄ ν•΄μ‹ ν•¨μλ” λ―Έμ μ©)
<img src="/assets/2022-06-08-homomorphism-in-rsa/020_sign.png" alt="020_sign.png" /></p>
  </li>
</ol>

<p>CTF μ RSA λ¬Έμ μ—μ„ μ„ μ†μ„±μ„ μ΄μ©ν• λ¬Έμ κ°€ κ½¤λ‚ μμ£Ό μ¶μ λλ©° ν•λ² μ‹¤μ λ΅ μ¶μ λ λ¬Έμ λ¥Ό ν’€μ–΄λ³΄λ©° μ–΄λ–¤ μ‹μΌλ΅ μ‘μ©λλ”μ§€ μ‚΄ν΄λ³΄μ.</p>

<h2 id="λ¬Έμ -ν’€μ΄">λ¬Έμ  ν’€μ΄</h2>

<ul>
  <li>LINECTF2022</li>
</ul>

<table>
  <thead>
    <tr>
      <th>λ¬Έμ λ…</th>
      <th>X Factor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>λ‚μ΄λ„</td>
      <td>Easy</td>
    </tr>
    <tr>
      <td>μ„¤λ…</td>
      <td>Decrypt it!</td>
    </tr>
    <tr>
      <td>μ κ³µνμΌ</td>
      <td><a href="/assets/2022-06-08-homomorphism-in-rsa/x_factor.md">x_factor.md</a></td>
    </tr>
  </tbody>
</table>

<p>λ¨Όμ €, μ κ³µλ νμΌμ„ μ—΄μ–΄μ„ ν™•μΈν•΄λ³΄μ.</p>

<p><strong>Β» Part 1</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">I</span> <span class="n">have</span> <span class="n">generated</span> <span class="n">a</span> <span class="n">RSA</span><span class="o">-</span><span class="mi">1024</span> <span class="n">key</span> <span class="n">pair</span><span class="p">:</span>
<span class="o">*</span> <span class="n">public</span> <span class="n">key</span> <span class="n">exponent</span><span class="p">:</span> <span class="mh">0x10001</span>
<span class="o">*</span> <span class="n">public</span> <span class="n">key</span> <span class="n">modulus</span><span class="p">:</span> <span class="mh">0xa9e7da28ebecf1f88efe012b8502122d70b167bdcfa11fd24429c23f27f55ee2cc3dcd7f337d0e630985152e114830423bfaf83f4f15d2d05826bf511c343c1b13bef744ff2232fb91416484be4e130a007a9b432225c5ead5a1faf02fa1b1b53d1adc6e62236c798f76695bb59f737d2701fe42f1fbf57385c29de12e79c5b3</span>
</code></pre></div></div>

<p>μ²«λ²μ§Έλ΅ <code class="language-plaintext highlighter-rouge">RSA κ³µκ°ν‚¤ μ(Public Exponent: e, Public Modulus: n)</code>μ„ 16μ§„μ ν•νƒλ΅ μ κ³µν•΄μ£Όκ³  μλ‹¤.</p>

<p><strong>Β» Part 2</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Here</span> <span class="n">are</span> <span class="n">some</span> <span class="n">known</span> <span class="n">plain</span> <span class="o">-&gt;</span> <span class="n">signature</span> <span class="n">pairs</span> <span class="n">I</span> <span class="n">generated</span> <span class="n">using</span> <span class="n">my</span> <span class="n">private</span> <span class="n">key</span><span class="p">:</span>
<span class="o">*</span> <span class="mh">0x945d86b04b2e7c7</span> <span class="o">-&gt;</span> <span class="mh">0x17bb21949d5a0f590c6126e26dc830b51d52b8d0eb4f2b69494a9f9a637edb1061bec153f0c1d9dd55b1ad0fd4d58c46e2df51d293cdaaf1f74d5eb2f230568304eebb327e30879163790f3f860ca2da53ee0c60c5e1b2c3964dbcf194c27697a830a88d53b6e0ae29c616e4f9826ec91f7d390fb42409593e1815dbe48f7ed4</span>
<span class="o">*</span> <span class="mh">0x5de2</span> <span class="o">-&gt;</span> <span class="mh">0x3ea73715787028b52796061fb887a7d36fb1ba1f9734e9fd6cb6188e087da5bfc26c4bfe1b4f0cbfa0d693d4ac0494efa58888e8415964c124f7ef293a8ee2bc403cad6e9a201cdd442c102b30009a3b63fa61cdd7b31ce9da03507901b49a654e4bb2b03979aea0fab3731d4e564c3c30c75aa1d079594723b60248d9bdde50</span>
<span class="o">*</span> <span class="mh">0xa16b201cdd42ad70da249</span> <span class="o">-&gt;</span> <span class="mh">0x9444e3fc71056d25489e5ce78c6c986c029f12b61f4f4b5cbd4a0ce6b999919d12c8872b8f2a8a7e91bd0f263a4ead8f2aa4f7e9fdb9096c2ea11f693f6aa73d6b9d5e351617d6f95849f9c73edabd6a6fde6cc2e4559e67b0e4a2ea8d6897b32675be6fc72a6172fd42a8a8e96adfc2b899015b73ff80d09c35909be0a6e13a</span>
<span class="o">*</span> <span class="mh">0x6d993121ed46b</span> <span class="o">-&gt;</span> <span class="mh">0x2b7a1c4a1a9e9f9179ab7b05dd9e0089695f895864b52c73bfbc37af3008e5c187518b56b9e819cc2f9dfdffdfb86b7cc44222b66d3ea49db72c72eb50377c8e6eb6f6cbf62efab760e4a697cbfdcdc47d1adc183cc790d2e86490da0705717e5908ad1af85c58c9429e15ea7c83ccf7d86048571d50bd721e5b3a0912bed7c</span>
<span class="o">*</span> <span class="mh">0x726fa7a7</span> <span class="o">-&gt;</span> <span class="mh">0xa7d5548d5e4339176a54ae1b3832d328e7c512be5252dabd05afa28cd92c7932b7d1c582dc26a0ce4f06b1e96814ee362ed475ddaf30dd37af0022441b36f08ec8c7c4135d6174167a43fa34f587abf806a4820e4f74708624518044f272e3e1215404e65b0219d42a706e5c295b9bf0ee8b7b7f9b6a75d76be64cf7c27dfaeb</span>
<span class="o">*</span> <span class="mh">0x31e828d97a0874cff</span> <span class="o">-&gt;</span> <span class="mh">0x67832c41a913bcc79631780088784e46402a0a0820826e648d84f9cc14ac99f7d8c10cf48a6774388daabcc0546d4e1e8e345ee7fc60b249d95d953ad4d923ca3ac96492ba71c9085d40753cab256948d61aeee96e0fe6c9a0134b807734a32f26430b325df7b6c9f8ba445e7152c2bf86b4dfd4293a53a8d6f003bf8cf5dffd</span>
<span class="o">*</span> <span class="mh">0x904a515</span> <span class="o">-&gt;</span> <span class="mh">0x927a6ecd74bb7c7829741d290bc4a1fd844fa384ae3503b487ed51dbf9f79308bb11238f2ac389f8290e5bcebb0a4b9e09eda084f27add7b1995eeda57eb043deee72bfef97c3f90171b7b91785c2629ac9c31cbdcb25d081b8a1abc4d98c4a1fd9f074b583b5298b2b6cc38ca0832c2174c96f2c629afe74949d97918cbee4a</span>
</code></pre></div></div>

<p>λ‘λ²μ§Έλ΅ <code class="language-plaintext highlighter-rouge">(ν‰λ¬Έ - μ„λ…)</code> μ 7 κ°λ¥Ό 16μ§„μ ν•νƒλ΅ μ κ³µν•΄μ£Όκ³  μλ‹¤.</p>

<p><strong>Β» Part 3</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>**What is the signature of 0x686178656c696f6e?**

Take the least significant 16 bytes of the signature, encode them in lowercase hexadecimal and format it as `LINECTF{sig_lowest_16_bytes_hex}` to obtain the flag.
E.g. the last signature from the list above would become `LINECTF{174c96f2c629afe74949d97918cbee4a}`.
</code></pre></div></div>

<p>μ„Έλ²μ§Έλ΅ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ <strong>μ„λ…μ΄ λ¬΄μ—‡μΈμ§€</strong> λ§μ¶°λ³΄λΌλ©° μ„λ…μ 16μ§„μ ν•νƒμ λ§μ§€λ§‰ 16 λ°”μ΄νΈλ¥Ό FLAG ν•μ‹μ— λ§μ¶° μ μ¶ν•λ©΄ λλ‹¤κ³  ν•λ‹¤.</p>

<p>ν„μ¬ μ°λ¦¬κ°€ μ•κ³  μλ” μ •λ³΄λ” <code class="language-plaintext highlighter-rouge">κ³µκ°ν‚¤(e, n)</code>μ™€ <code class="language-plaintext highlighter-rouge">(ν‰λ¬Έ - μ„λ…)</code> μ 7κ°, κ·Έλ¦¬κ³  FLAG μΈ μ„λ…μ„ κµ¬ν•κΈ° μ„ν•΄ ν•„μ”ν• ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> λΏμ΄λ‹¤. μλ―Έλ¥Ό μ• μ μ—†λ” 16μ§„μ ν•νƒμ μ«μλ΅λ§ κ°€λ“ν• ν…μ¤νΈλ΅λ¶€ν„° <strong>μ–΄λ–»κ² κ°μΈν‚¤ d λ„ μ—†μ΄ μ„λ…μ„ κµ¬ν•  μ μμ„κΉ?</strong></p>

<p>λ°”λ΅ μ„μ—μ„ λ°°μ΄ μ¤€λ™ν• μ‚¬μƒ(Homomorphism)μ„ μ΄μ©ν•μ—¬ ν’€λ©΄ λλ‹¤.</p>

<p>λ¨Όμ € ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ„ μ†μΈμλ¶„ν•΄ ν•΄λ³΄λ©΄ λ‹¤μκ³Ό κ°™λ‹¤ (SageMath μ factor ν•¨μ):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Implemented in SageMath
</span><span class="n">target</span> <span class="o">=</span> <span class="mh">0x686178656c696f6e</span>   <span class="c1"># 7521425229691318126
</span><span class="n">factor</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>   <span class="c1"># 2 * 197 * 947 * 2098711 * 9605087
</span></code></pre></div></div>

<p>μ„μ™€ κ°™μ΄ 5 κ°μ μ†μΈμμ κ³±μΌλ΅ ν‰λ¬Έμ„ ν‘ν„ν•  μ μλ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤. (m = a * b * c * d * e)</p>

<p>μ΄λ²μ—λ” μ£Όμ–΄μ΅λ (ν‰λ¬Έ - μ„λ…) μμ—μ„ ν‰λ¬Έλ“¤λ§ μ†μΈμλ¶„ν•΄ ν•΄λ³΄λ©΄ λ‹¤μκ³Ό κ°™λ‹¤:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pt1</span> <span class="o">=</span> <span class="mh">0x945d86b04b2e7c7</span>
<span class="n">pt2</span> <span class="o">=</span> <span class="mh">0x5de2</span>
<span class="n">pt3</span> <span class="o">=</span> <span class="mh">0xa16b201cdd42ad70da249</span>
<span class="n">pt4</span> <span class="o">=</span> <span class="mh">0x6d993121ed46b</span>
<span class="n">pt5</span> <span class="o">=</span> <span class="mh">0x726fa7a7</span>
<span class="n">pt6</span> <span class="o">=</span> <span class="mh">0x31e828d97a0874cff</span>
<span class="n">pt7</span> <span class="o">=</span> <span class="mh">0x904a515</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">pt3</span><span class="p">,</span> <span class="n">pt4</span><span class="p">,</span> <span class="n">pt5</span><span class="p">,</span> <span class="n">pt6</span><span class="p">,</span> <span class="n">pt7</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"pt</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">: "</span><span class="p">,</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"factor(pt</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">): "</span><span class="p">,</span> <span class="n">factor</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">print</span><span class="p">()</span>

<span class="s">'''
[+] Output: 
pt1:  668178073886320583
factor(pt1):  811 * 947^3 * 970111

pt2:  24034
factor(pt2):  2 * 61 * 197

pt3:  12196433909207788967273033
factor(pt3):  970111 * 2098711^2 * 2854343

pt4:  1928075547694187
factor(pt4):  947 * 970111 * 2098711

pt5:  1919920039
factor(pt5):  61 * 197^2 * 811

pt6:  57538707471611677951
factor(pt6):  2098711 * 2854343 * 9605087

pt7:  151299349
factor(pt7):  197 * 811 * 947
'''</span>
</code></pre></div></div>

<p>μ‹ κΈ°ν•κ²λ„ λ‡λ‡ μ†μΈμλ“¤μ΄ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ <strong>μ†μΈμλ“¤κ³Ό κ²ΉμΉλ‹¤</strong>λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. μ†μΈμκ°€ κ²ΉμΉλ”κ² λ­ μ–΄λ–»κΈΈλ κ·Έλ°κ±ΈκΉ? μ°λ¦¬λ” 7 κ°μ <code class="language-plaintext highlighter-rouge">(ν‰λ¬Έ - μ„λ…)</code> μμ„ μ•κ³  μκΈ° λ•λ¬Έμ— ν•΄λ‹Ή ν‰λ¬Έμ„ <strong>μ μ΅°ν•©</strong>ν•΄μ„ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> κ³Ό μΌμΉν•κ² λ§λ“ λ‹¤λ©΄ RSA μ—μ„μ <strong>μ¤€λ™ν• μ‚¬μƒ</strong>μΌλ΅ μΈν•΄ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ— κ°μΈν‚¤ d λ¥Ό μ΄μ©ν•μ—¬ κ³„μ‚°ν• μ„λ…κ³Ό λ™μΌν• μ„λ…μ„ <strong>κ°μΈν‚¤ d μ—†μ΄λ„ κµ¬ν•  μ μκ² λλ‹¤.</strong></p>

<h2 id="μ΄κ²-λ¬΄μ¨-μ†λ¦¬">μ΄κ² λ¬΄μ¨ μ†λ¦¬?</h2>

<p>μ„μ—μ„ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ΄ 5 κ°μ μ†μΈμμ κ³± ν•νƒλ΅ ν‘ν„μ΄ κ°€λ¥ν•λ‹¤λ” κ²ƒμ„ μ•μ•λ‹¤.</p>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/021_m_factor.png" alt="021_m_factor.png" /></p>

<p>μ°λ¦¬λ” κ°μΈν‚¤ d λ¥Ό λ¨λ¥΄κΈ° λ•λ¬Έμ— m μ— λ€ν• μ„λ…μ„ κµ¬ν•  μ μ—†μ§€λ§, 7 κ°μ (ν‰λ¬Έ - μ„λ…) μμ„ μ•κ³  μκ³  κ° ν‰λ¬Έμ μ†μΈμκ°€ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ μ†μΈμμ™€ κ²ΉμΉκΈ° λ•λ¬Έμ— κ³±ν•κΈ°μ™€ λ‚λ„κΈ°λ¥Ό μ μ ν μ΄μ©ν•μ—¬ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> κ³Ό μΌμΉν•λ” μλ¥Ό κµ¬ν•  μ μλ‹¤λ©΄ ν•΄λ‹Ή μλ¥Ό κµ¬ν–μ„ λ•μ μ‹κ³Ό λ™μΌν•κ² 7 κ°μ μ„λ…μ— μ μ©ν•μ—¬ κ³„μ‚°ν•λ©΄ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> μ— κ°μΈν‚¤ d λ¥Ό μ΄μ©ν•μ—¬ κ³„μ‚°ν• μ„λ…κ³Ό λ™μΌν• μ„λ…μ„ κ°μΈν‚¤ d μ—†μ΄λ„ κµ¬ν•  μ μκ² λλ‹¤λ” λ§μ΄λ‹¤.</p>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/022_m_sign.png" alt="022_m_sign.png" /></p>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/023_find_m.png" alt="023_find_m.png" /></p>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/024_original_signature.png" alt="024_original_signature.png" /></p>

<p>(ν„μ¬λ΅μ¨λ” κ³±ν•κΈ°, λ‚λ„κΈ° μ¤‘ μ–΄λ–¤ μ—°μ‚°μκ°€ λ“¤μ–΄κ°€μ•Ό ν•λ”μ§€ λ¨λ¥΄κΈ° λ•λ¬Έμ— λ¬Όμν‘(β€™?β€™)λ΅ λ‘μ—λ‹¤.)</p>

<p>ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> (target)κ³Ό μΌμΉν•λ” μλ¥Ό κµ¬ν•κΈ° μ„ν•΄μ„λ” μ•½κ°„μ λ¨Έλ¦¬λ¥Ό μ¨μ„ 7 κ°μ ν‰λ¬Έμ„ κ³±ν•κ³  λ‚λ„λ©΄ λλ‹¤. λ‚μ κ²½μ°μ—λ” μ‘μ€ μ†μΈμλ¥Ό κ°€μ§„ ν‰λ¬Έλ¶€ν„° μμ„λ€λ΅ λ‚μ—΄ν•΄λ³΄μ•λ‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pt2   : 2 * 61 * 197
pt5   :     61 * 197^2 * 811
pt7   :          197   * 811 * 947
pt1   :                  811 * 947^3 * 970111
pt4   :                        947   * 970111 * 2098711
pt3   :                                970111 * 2098711^2 * 2854343
pt6   :                                         2098711   * 2854343 * 9605087
-----------------------------------------------------------------------------
target: 2      * 197         * 947            * 2098711             * 9605087
</code></pre></div></div>

<p>μ΄μ  κ³±ν•κΈ°, λ‚λ„κΈ°λ¥Ό μ΄μ©ν•μ—¬ target κ³Ό μΌμΉν•λ” μλ¥Ό λ§λ“¤λ©΄ λλ‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    pt2: 2 * 61 * 197
(/) pt5:     61 * 197^2    * 811
-----------------------------------------------------------------------------------------
         2      * 197^(-1) * 811^(-1)
(*) pt7:          197      * 811      * 947
-----------------------------------------------------------------------------------------
         2                            * 947
(*) pt7:          197      * 811      * 947
-----------------------------------------------------------------------------------------
         2      * 197      * 811      * 947^2
(/) pt1:                     811      * 947^3    * 970111
-----------------------------------------------------------------------------------------
         2      * 197                 * 947^(-1) * 970111^(-1)
(*) pt4:                                947      * 970111 * 2098711
-----------------------------------------------------------------------------------------
         2      * 197                                     * 2098711
(*) pt4:                                947      * 970111 * 2098711
-----------------------------------------------------------------------------------------
         2      * 197                 * 947      * 970111 * 2098711^2
(/) pt3:                                           970111 * 2098711^2 * 2854343
-----------------------------------------------------------------------------------------
         2      * 197                 * 947                           * 2854343^(-1)
(*) pt6:                                                    2098711   * 2854343 * 9605087
-----------------------------------------------------------------------------------------
 answer: 2      * 197                 * 947               * 2098711             * 9605087

Therefore, answer = pt2 / pt5 * pt7^2 / pt1 * pt4^2 / pt3 * pt6.
</code></pre></div></div>

<p>7 κ°μ ν‰λ¬Έμ„ μ΄μ©ν•μ—¬ ν‰λ¬Έ <code class="language-plaintext highlighter-rouge">0x686178656c696f6e</code> (target)κ³Ό μΌμΉν•λ” μ(answer)λ¥Ό κµ¬ν–κΈ° λ•λ¬Έμ— μ΄μ  7 κ°μ μ„λ…μ„ μ΄μ©ν•μ—¬ λ™μΌν• μ‹μΌλ΅ target μ μ„λ…μ„ κµ¬ν•  μ μλ‹¤.</p>

<p>μ•„λλ” target μ μ„λ…κ³Ό FLAG λ¥Ό κµ¬ν•κΈ° μ„ν•΄ μ‚¬μ©ν• μ½”λ“μ΄λ‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Implemented in SageMath
</span><span class="n">target</span> <span class="o">=</span> <span class="mh">0x686178656c696f6e</span>
<span class="k">print</span><span class="p">(</span><span class="s">"target: "</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>   <span class="c1"># 7521425229691318126
</span><span class="k">print</span><span class="p">(</span><span class="s">"factor(target): "</span><span class="p">,</span> <span class="n">factor</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>   <span class="c1"># 2 * 197 * 947 * 2098711 * 9605087
</span><span class="k">print</span><span class="p">()</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">pt2</span> <span class="o">/</span> <span class="n">pt5</span> <span class="o">*</span> <span class="n">pt7</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="n">pt1</span> <span class="o">*</span> <span class="n">pt4</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="n">pt3</span> <span class="o">*</span> <span class="n">pt6</span>
<span class="k">print</span><span class="p">(</span><span class="s">"answer: "</span><span class="p">,</span> <span class="n">answer</span><span class="p">)</span>   <span class="c1"># 7521425229691318126
</span><span class="k">print</span><span class="p">(</span><span class="s">"factor(answer): "</span><span class="p">,</span> <span class="n">factor</span><span class="p">(</span><span class="n">answer</span><span class="p">))</span>   <span class="c1"># 2 * 197 * 947 * 2098711 * 9605087
</span><span class="k">print</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">target</span> <span class="o">==</span> <span class="n">answer</span>

<span class="c1"># Using the same formula as answer including modular n.
# This is possible because of the homomorphism in unpadded RSA.
</span><span class="n">newsig</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig2</span> <span class="o">/</span> <span class="n">sig5</span> <span class="o">*</span> <span class="n">sig7</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="n">sig1</span> <span class="o">*</span> <span class="n">sig4</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="n">sig3</span> <span class="o">*</span> <span class="n">sig6</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
<span class="k">print</span><span class="p">(</span><span class="s">"newsig (int): "</span><span class="p">,</span> <span class="n">newsig</span><span class="p">)</span>
<span class="c1"># 111219533890621461179460792242241632450808153632799554790302537773885731996725665970159819970061237994467913213678895572474822930918390150774003109045699291202079975387595071497569834504251162974827309324614046581068300485342202365281472704413710935864495616184160512233863134373547246784976501532318112012352
</span><span class="n">newsig</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">newsig</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span class="k">print</span><span class="p">(</span><span class="s">"newsig (hex): "</span><span class="p">,</span> <span class="n">newsig</span><span class="p">)</span>
<span class="c1"># 9e61c276f698ec48aab7dabfd663f3b2ee75d31c68bf16f6810a3bb9bb1c377e47b2ae8cd7055c7c5848bbedc94798d2965c38b317e42191df0e3f25ca2ee58c5f3e125745479b337516a13e420da29ba48a92ca2ee9720487cda6cdf070e83a4a251c52e331174a0ef642a97a251462a049347a7db8226d496eb55c15b1d840
</span><span class="k">print</span><span class="p">()</span>

<span class="s">'''
Take the least significant 16 bytes of the signature, encode them in lowercase hexadecimal and format it as `LINECTF{sig_lowest_16_bytes_hex}` to obtain the flag.
E.g. the last signature from the list above would become `LINECTF{174c96f2c629afe74949d97918cbee4a}`.
'''</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s">'LINECTF{'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">newsig</span><span class="p">[</span><span class="o">-</span><span class="mi">32</span><span class="p">:])</span> <span class="o">+</span> <span class="s">'}'</span>
<span class="k">print</span><span class="p">(</span><span class="s">"flag: "</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
<span class="c1"># flag:  LINECTF{a049347a7db8226d496eb55c15b1d840}
</span></code></pre></div></div>

<aside>
π© FLAG : LINECTF{a049347a7db8226d496eb55c15b1d840}

</aside>

<hr />

<h1 id="κ²°λ΅ ">κ²°λ΅ </h1>

<p><img src="/assets/2022-06-08-homomorphism-in-rsa/025_philip-estrada-vJr3t39a0xw-unsplash_edit.jpg" alt="025_philip-estrada-vJr3t39a0xw-unsplash_edit.jpg" /></p>

<p>μ§€κΈκΉμ§€ <strong>RSA</strong> λ€ λ¬΄μ—‡μΈμ§€, <strong>ν‚¤ μƒμ„±</strong>, <strong>μ•”/λ³µνΈν™”</strong>, <strong>μ„λ…/κ²€μ¦</strong>μ€ μ–΄λ–»κ² μ΄λ£¨μ–΄μ§€λ”μ§€ μ•μ•„λ³΄μ•κ³ , λ λ€μν•™μ—μ„μ <strong>μ¤€λ™ν• μ‚¬μƒ(Homomorphism)</strong> κ°λ…μ„ CTF μ—μ„ μμ£Ό μ¶μ λλ” μ ν•μ RSA λ¬Έμ μ— μ μ©ν•μ—¬ ν’€μ–΄λ³΄μ•λ‹¤. μ΄μ™Έμ—λ„ μλ§μ€ λ°©μ‹μ RSA κ³µκ²© κΈ°λ²•λ“¤μ΄ μ΅΄μ¬ν•μ§€λ§ λ€λ¶€λ¶„ μ„ λ¬Έμ  ν’€μ΄μ—μ„ λ³Έ κ²ƒκ³Ό κ°™μ΄ μν•™μ μΈ κ°λ…μ„ κ°€μ§€κ³  μ‚¬μΉ™μ—°μ‚°λ§ ν•  μ¤„ μ•λ‹¤λ©΄ κΈλ°© μ΄ν•΄ν•κ³  κ·Έκ²ƒμ„ λ¬Έμ μ— μ μ©ν•  μ μμ„ κ²ƒμ΄λ‹¤.</p>

<p><strong>μ•”νΈ</strong>λ¥Ό ν‘Όλ‹¤λ” κ²ƒμ€ <strong>μ–½νκ³ μ„¤ν‚¨ μ‹¤νƒ€λλ¥Ό ν‘Έλ” κ²ƒ</strong>κ³Όλ„ κ°™λ‹¤κ³  μƒκ°ν•λ‹¤. μ²μ λ¬Έμ λ¥Ό μ ‘ν–μ„ λ•λ” λ„λ¬΄μ§€ μ–΄λ–»κ² μ΄κ²ƒμ„ ν’€μ–΄μ•Ό ν•λ‹¤λ” κ±΄μ§€ κ°μ„ μ΅μ„ μμ΅°μ°¨ μ—†μ§€λ§ μ²μ²ν λ‘λ¬λ³΄λ‹¤ λ³΄λ©΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μλ” <strong>μ‹¤λ§λ¦¬</strong>λ¥Ό μ΅μ„ μ μμ„ κ²ƒμ΄λ‹¤. μ΄ κΈ€μ΄ μ•”νΈν•™ λ¬Έμ λ¥Ό ν‘Έλ” μ΄λ“¤μ—κ² μΆ‹μ€ μ‹μ‘μ μ΄ λκΈ°λ¥Ό κΈ°μ›ν•λ©° κΈ€μ„ λ§λ¬΄λ¦¬ν•λ„λ΅ ν•κ² λ‹¤.</p>

    <div class="page-profile-detail">
        <div class="page-profile-detail-info">
            <div>
                <img class="page-profile_image-detail" src="/assets/stealien_inverse.png" />
            </div>
            <div style="position: relative; top: 12px;left: 10px;">
                <div class="page-profile-author">λ°•μ§€μ›</div>
                <div class="page-profile-email">jwpark@stealien.com</div>
            </div>
        </div>
    </div>
</div>

<div class="recent-post-area">
    <div class="posts container">
        <div class="h1-recent-post">RECENT POST</div>
            <div class="row">
    <div class="col-sm-2 col-md-2">
        <div class="profile">
            <img src="/assets/stealien_inverse.png" class="profile_image" />
            <div class="profile_author">Minjoong Kim</div>
        </div>
    </div>
    <div class="col">
        <a href="/2024-03-10/Android-1day-Exploit-Analysis-ko">
            <div class="post-title">
                Android 1day Exploit Analysis (CVE-2019-2215)
            </div>
        </a>
        <div class="post-summary">Android 1day Exploit Analysis by Newbie</div>
        <div class="post-info">
            <span style="color: #545454" class="post-author-mobile">
                Minjoong Kim
                <span style="color: #f5f5f5; margin: 2px">|</span>
            </span>
            Mar 10, 2024
            <span style="color: #f5f5f5; margin: 2px">|</span>
            <span>R&D</span>
        </div>
    </div>
</div><div class="row">
    <div class="col-sm-2 col-md-2">
        <div class="profile">
            <img src="/assets/stealien_inverse.png" class="profile_image" />
            <div class="profile_author">μ΄μ£Όν‘, μ΄μ£Όμ</div>
        </div>
    </div>
    <div class="col">
        <a href="/2024-02-05/IoT-TechBlog-ko">
            <div class="post-title">
                λ‰΄λΉ„λ“¤μ ν•λ“μ›¨μ–΄ ν•΄ν‚Ή μ…λ¬ΈκΈ°
            </div>
        </a>
        <div class="post-summary">λ‰΄λΉ„λ“¤μ ν•λ“μ›¨μ–΄ ν•΄ν‚Ή μ…λ¬ΈκΈ°</div>
        <div class="post-info">
            <span style="color: #545454" class="post-author-mobile">
                μ΄μ£Όν‘, μ΄μ£Όμ
                <span style="color: #f5f5f5; margin: 2px">|</span>
            </span>
            Feb 5, 2024
            <span style="color: #f5f5f5; margin: 2px">|</span>
            <span>R&D</span>
        </div>
    </div>
</div>
        </div>
    </div>
</div>
		</div>
	</section><footer>
  <div class="container" style="display: flex; justify-content: space-between;">
    <!-- <a href="#top">
      <img src="/assets/white_logo.png" class="footer-logo" />
    </a> -->
    <div class="footer-copyright">Copyright &copy; Stealien Inc.</div>
    <div class="footer-icons">
      <a target="_blank" href="https://twitter.com/stealien"><img class="sns" src="/assets/icons/twitter_ic.png"/></a>
      <a target="_blank" href="https://blog.naver.com/stealien_official"><img class="sns" src="/assets/icons/blog_ic.png"/></a>
      <a target="_blank" href="https://www.facebook.com/stealien/"><img class="sns" src="/assets/icons/facebook_ic.png"/></a>
      <a target="_blank" href="https://www.youtube.com/c/STEALIEN"><img class="sns" src="/assets/icons/youtube_ic.png"/></a>
    </div>
  </div>
</footer></body>
</html>
